From bbf05ec417e104b761e704da802ab4ca9689999d Mon Sep 17 00:00:00 2001
From: Mark Harfouche <mark.harfouche@gmail.com>
Date: Mon, 25 Sep 2023 02:20:58 -0400
Subject: [PATCH 5/9] Use qtpy instead of PySide6

---
 deeplabcut/__main__.py                          |  2 +-
 deeplabcut/gui/__init__.py                      |  3 ---
 deeplabcut/gui/components.py                    |  4 ++--
 deeplabcut/gui/launch_script.py                 |  6 +++---
 deeplabcut/gui/tabs/analyze_videos.py           |  4 ++--
 deeplabcut/gui/tabs/create_project.py           |  4 ++--
 deeplabcut/gui/tabs/create_training_dataset.py  |  6 +++---
 deeplabcut/gui/tabs/create_videos.py            |  4 ++--
 deeplabcut/gui/tabs/evaluate_network.py         |  4 ++--
 deeplabcut/gui/tabs/extract_frames.py           |  4 ++--
 deeplabcut/gui/tabs/extract_outlier_frames.py   |  4 ++--
 deeplabcut/gui/tabs/label_frames.py             |  4 ++--
 deeplabcut/gui/tabs/manage_project.py           |  4 ++--
 deeplabcut/gui/tabs/modelzoo.py                 |  6 +++---
 deeplabcut/gui/tabs/open_project.py             |  6 +++---
 deeplabcut/gui/tabs/refine_tracklets.py         |  4 ++--
 deeplabcut/gui/tabs/train_network.py            |  6 +++---
 deeplabcut/gui/tabs/unsupervised_id_tracking.py |  4 ++--
 deeplabcut/gui/tabs/video_editor.py             |  4 ++--
 deeplabcut/gui/tracklet_toolbox.py              |  4 ++--
 deeplabcut/gui/utils.py                         |  2 +-
 deeplabcut/gui/widgets.py                       |  4 ++--
 deeplabcut/gui/window.py                        | 10 +++++-----
 23 files changed, 50 insertions(+), 53 deletions(-)

diff --git a/deeplabcut/__main__.py b/deeplabcut/__main__.py
index 93b3f44..3d9f668 100644
--- a/deeplabcut/__main__.py
+++ b/deeplabcut/__main__.py
@@ -10,7 +10,7 @@
 #
 
 try:
-    import PySide6
+    import qtpy
 
     lite = False
 except ModuleNotFoundError:
diff --git a/deeplabcut/gui/__init__.py b/deeplabcut/gui/__init__.py
index 484f139..0dba5a2 100644
--- a/deeplabcut/gui/__init__.py
+++ b/deeplabcut/gui/__init__.py
@@ -11,7 +11,4 @@
 
 import os
 
-os.environ["QT_API"] = "pyside6"
-import qtpy  # Necessary unused import to properly store the env variable
-
 BASE_DIR = os.path.dirname(__file__)
diff --git a/deeplabcut/gui/components.py b/deeplabcut/gui/components.py
index f164804..76659dd 100644
--- a/deeplabcut/gui/components.py
+++ b/deeplabcut/gui/components.py
@@ -10,8 +10,8 @@
 #
 import os
 
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 from deeplabcut.gui.dlc_params import DLCParams
 from deeplabcut.gui.widgets import ConfigEditor
 
diff --git a/deeplabcut/gui/launch_script.py b/deeplabcut/gui/launch_script.py
index 6ada864..9350ede 100644
--- a/deeplabcut/gui/launch_script.py
+++ b/deeplabcut/gui/launch_script.py
@@ -22,11 +22,11 @@ import sys
 import os
 import logging
 
-import PySide6.QtWidgets as QtWidgets
+import qtpy.QtWidgets as QtWidgets
 import qdarkstyle
 from deeplabcut.gui import BASE_DIR
-from PySide6.QtCore import Qt
-from PySide6.QtGui import QIcon, QPixmap
+from qtpy.QtCore import Qt
+from qtpy.QtGui import QIcon, QPixmap
 
 
 def launch_dlc():
diff --git a/deeplabcut/gui/tabs/analyze_videos.py b/deeplabcut/gui/tabs/analyze_videos.py
index 3919446..7ff885a 100644
--- a/deeplabcut/gui/tabs/analyze_videos.py
+++ b/deeplabcut/gui/tabs/analyze_videos.py
@@ -9,8 +9,8 @@
 # Licensed under GNU Lesser General Public License v3.0
 #
 from functools import partial
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 from deeplabcut.gui.utils import move_to_separate_thread
 from deeplabcut.gui.widgets import ConfigEditor
diff --git a/deeplabcut/gui/tabs/create_project.py b/deeplabcut/gui/tabs/create_project.py
index 6eaf66f..ba4479b 100644
--- a/deeplabcut/gui/tabs/create_project.py
+++ b/deeplabcut/gui/tabs/create_project.py
@@ -17,8 +17,8 @@ from deeplabcut.gui import BASE_DIR
 from deeplabcut.gui.dlc_params import DLCParams
 from deeplabcut.gui.widgets import ClickableLabel, ItemSelectionFrame
 
-from PySide6 import QtCore, QtWidgets
-from PySide6.QtGui import QIcon
+from qtpy import QtCore, QtWidgets
+from qtpy.QtGui import QIcon
 
 
 class ProjectCreator(QtWidgets.QDialog):
diff --git a/deeplabcut/gui/tabs/create_training_dataset.py b/deeplabcut/gui/tabs/create_training_dataset.py
index e640a5c..7c409d9 100644
--- a/deeplabcut/gui/tabs/create_training_dataset.py
+++ b/deeplabcut/gui/tabs/create_training_dataset.py
@@ -10,9 +10,9 @@
 #
 import os
 
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
-from PySide6.QtGui import QIcon
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
+from qtpy.QtGui import QIcon
 
 from deeplabcut.gui.dlc_params import DLCParams
 from deeplabcut.gui.components import (
diff --git a/deeplabcut/gui/tabs/create_videos.py b/deeplabcut/gui/tabs/create_videos.py
index e2018ed..11ec231 100644
--- a/deeplabcut/gui/tabs/create_videos.py
+++ b/deeplabcut/gui/tabs/create_videos.py
@@ -8,8 +8,8 @@
 #
 # Licensed under GNU Lesser General Public License v3.0
 #
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 from deeplabcut.gui.components import (
     BodypartListWidget,
diff --git a/deeplabcut/gui/tabs/evaluate_network.py b/deeplabcut/gui/tabs/evaluate_network.py
index 964a26b..dc349f8 100644
--- a/deeplabcut/gui/tabs/evaluate_network.py
+++ b/deeplabcut/gui/tabs/evaluate_network.py
@@ -14,8 +14,8 @@ from matplotlib.backends.backend_qt5agg import (
     FigureCanvasQTAgg as FigureCanvas,
 )
 from matplotlib.figure import Figure
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 import deeplabcut
 from deeplabcut.utils.auxiliaryfunctions import get_evaluation_folder
diff --git a/deeplabcut/gui/tabs/extract_frames.py b/deeplabcut/gui/tabs/extract_frames.py
index 702be26..b873cab 100644
--- a/deeplabcut/gui/tabs/extract_frames.py
+++ b/deeplabcut/gui/tabs/extract_frames.py
@@ -10,8 +10,8 @@
 #
 from functools import partial
 
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 from deeplabcut.gui.dlc_params import DLCParams
 from deeplabcut.gui.components import (
diff --git a/deeplabcut/gui/tabs/extract_outlier_frames.py b/deeplabcut/gui/tabs/extract_outlier_frames.py
index 2a655e7..f1096fc 100644
--- a/deeplabcut/gui/tabs/extract_outlier_frames.py
+++ b/deeplabcut/gui/tabs/extract_outlier_frames.py
@@ -8,8 +8,8 @@
 #
 # Licensed under GNU Lesser General Public License v3.0
 #
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 from deeplabcut.gui.dlc_params import DLCParams
 from deeplabcut.gui.components import (
diff --git a/deeplabcut/gui/tabs/label_frames.py b/deeplabcut/gui/tabs/label_frames.py
index 507f61a..aa1ba80 100644
--- a/deeplabcut/gui/tabs/label_frames.py
+++ b/deeplabcut/gui/tabs/label_frames.py
@@ -9,8 +9,8 @@
 # Licensed under GNU Lesser General Public License v3.0
 #
 import os
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 from deeplabcut.generate_training_dataset import check_labels
 from deeplabcut.gui.components import DefaultTab
 from deeplabcut.gui.widgets import launch_napari
diff --git a/deeplabcut/gui/tabs/manage_project.py b/deeplabcut/gui/tabs/manage_project.py
index 932adcf..69be014 100644
--- a/deeplabcut/gui/tabs/manage_project.py
+++ b/deeplabcut/gui/tabs/manage_project.py
@@ -9,8 +9,8 @@
 # Licensed under GNU Lesser General Public License v3.0
 #
 import os
-from PySide6.QtCore import Qt
-from PySide6.QtWidgets import (
+from qtpy.QtCore import Qt
+from qtpy.QtWidgets import (
     QPushButton,
     QFileDialog,
     QLabel,
diff --git a/deeplabcut/gui/tabs/modelzoo.py b/deeplabcut/gui/tabs/modelzoo.py
index 26bc7ff..c946769 100644
--- a/deeplabcut/gui/tabs/modelzoo.py
+++ b/deeplabcut/gui/tabs/modelzoo.py
@@ -9,9 +9,9 @@
 # Licensed under GNU Lesser General Public License v3.0
 #
 import deeplabcut
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt, Signal, QTimer, QRegularExpression
-from PySide6.QtGui import QRegularExpressionValidator
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt, Signal, QTimer, QRegularExpression
+from qtpy.QtGui import QRegularExpressionValidator
 from deeplabcut.gui.components import (
     DefaultTab,
     VideoSelectionWidget,
diff --git a/deeplabcut/gui/tabs/open_project.py b/deeplabcut/gui/tabs/open_project.py
index 42985be..d0e4d04 100644
--- a/deeplabcut/gui/tabs/open_project.py
+++ b/deeplabcut/gui/tabs/open_project.py
@@ -10,9 +10,9 @@
 #
 import os
 
-from PySide6 import QtWidgets, QtCore
-from PySide6.QtGui import QIcon
-from PySide6.QtWidgets import QCheckBox
+from qtpy import QtWidgets, QtCore
+from qtpy.QtGui import QIcon
+from qtpy.QtWidgets import QCheckBox
 
 
 class OpenProject(QtWidgets.QDialog):
diff --git a/deeplabcut/gui/tabs/refine_tracklets.py b/deeplabcut/gui/tabs/refine_tracklets.py
index 25b4b51..00ad80a 100644
--- a/deeplabcut/gui/tabs/refine_tracklets.py
+++ b/deeplabcut/gui/tabs/refine_tracklets.py
@@ -10,8 +10,8 @@
 #
 import os
 from pathlib import Path
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 from deeplabcut.gui.widgets import ConfigEditor
 from deeplabcut.gui.components import (
diff --git a/deeplabcut/gui/tabs/train_network.py b/deeplabcut/gui/tabs/train_network.py
index f50f215..d9d2bf1 100644
--- a/deeplabcut/gui/tabs/train_network.py
+++ b/deeplabcut/gui/tabs/train_network.py
@@ -11,9 +11,9 @@
 import os
 from pathlib import Path
 
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
-from PySide6.QtGui import QIcon
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
+from qtpy.QtGui import QIcon
 
 from deeplabcut.gui.components import (
     DefaultTab,
diff --git a/deeplabcut/gui/tabs/unsupervised_id_tracking.py b/deeplabcut/gui/tabs/unsupervised_id_tracking.py
index 376c08d..6a28332 100644
--- a/deeplabcut/gui/tabs/unsupervised_id_tracking.py
+++ b/deeplabcut/gui/tabs/unsupervised_id_tracking.py
@@ -9,8 +9,8 @@
 # Licensed under GNU Lesser General Public License v3.0
 #
 from functools import partial
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 from deeplabcut.gui.components import (
     DefaultTab,
diff --git a/deeplabcut/gui/tabs/video_editor.py b/deeplabcut/gui/tabs/video_editor.py
index 38be396..12140ad 100644
--- a/deeplabcut/gui/tabs/video_editor.py
+++ b/deeplabcut/gui/tabs/video_editor.py
@@ -10,8 +10,8 @@
 #
 import time
 
-from PySide6 import QtWidgets
-from PySide6.QtCore import Qt
+from qtpy import QtWidgets
+from qtpy.QtCore import Qt
 
 from deeplabcut.gui.components import (
     DefaultTab,
diff --git a/deeplabcut/gui/tracklet_toolbox.py b/deeplabcut/gui/tracklet_toolbox.py
index 34b2785..1c30c13 100644
--- a/deeplabcut/gui/tracklet_toolbox.py
+++ b/deeplabcut/gui/tracklet_toolbox.py
@@ -20,8 +20,8 @@ from deeplabcut.utils.auxfun_videos import VideoReader
 from deeplabcut.utils.auxiliaryfunctions import attempt_to_make_folder
 from matplotlib.path import Path
 from matplotlib.widgets import Slider, LassoSelector, Button, CheckButtons
-from PySide6.QtWidgets import QMessageBox
-from PySide6.QtCore import QMutex
+from qtpy.QtWidgets import QMessageBox
+from qtpy.QtCore import QMutex
 
 
 class DraggablePoint:
diff --git a/deeplabcut/gui/utils.py b/deeplabcut/gui/utils.py
index cd5369f..c960126 100644
--- a/deeplabcut/gui/utils.py
+++ b/deeplabcut/gui/utils.py
@@ -8,7 +8,7 @@
 #
 # Licensed under GNU Lesser General Public License v3.0
 #
-from PySide6 import QtCore
+from qtpy import QtCore
 
 
 class Worker(QtCore.QObject):
diff --git a/deeplabcut/gui/widgets.py b/deeplabcut/gui/widgets.py
index 9765d20..1bd907d 100644
--- a/deeplabcut/gui/widgets.py
+++ b/deeplabcut/gui/widgets.py
@@ -25,8 +25,8 @@ from matplotlib.backends.backend_qt5agg import (
 from matplotlib.figure import Figure
 from matplotlib.widgets import RectangleSelector, Button, LassoSelector
 from queue import Queue
-from PySide6 import QtCore, QtWidgets
-from PySide6.QtGui import QStandardItemModel, QStandardItem, QCursor, QAction
+from qtpy import QtCore, QtWidgets
+from qtpy.QtGui import QStandardItemModel, QStandardItem, QCursor, QAction
 from scipy.spatial import cKDTree as KDTree
 from skimage import io
 
diff --git a/deeplabcut/gui/window.py b/deeplabcut/gui/window.py
index e891711..af12017 100644
--- a/deeplabcut/gui/window.py
+++ b/deeplabcut/gui/window.py
@@ -22,11 +22,11 @@ from deeplabcut import auxiliaryfunctions, VERSION
 from deeplabcut.gui import BASE_DIR, components, utils
 from deeplabcut.gui.tabs import *
 from deeplabcut.gui.widgets import StreamReceiver, StreamWriter
-from PySide6.QtWidgets import QMessageBox, QMenu, QWidget, QMainWindow
-from PySide6 import QtCore
-from PySide6.QtGui import QIcon, QAction
-from PySide6 import QtWidgets, QtGui
-from PySide6.QtCore import Qt
+from qtpy.QtWidgets import QMessageBox, QMenu, QWidget, QMainWindow
+from qtpy import QtCore
+from qtpy.QtGui import QIcon, QAction
+from qtpy import QtWidgets, QtGui
+from qtpy.QtCore import Qt
 
 
 def _check_for_updates():
-- 
2.40.1

